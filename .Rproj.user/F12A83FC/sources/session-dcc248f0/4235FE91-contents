---
title: "CSI:Dixie Greenville"
author: "Candy Boatwright"
format: html
---



```{r}
#load libraries
library(tidytext)
library(tidyverse)
library(readtext)
library(tm)
```



Stephen Berry in his book, Count the Dead, addresses the rise of the modern state and its correlation with the quantification of death. During the legislative session of 1849 a tremendous reform was passed through the United States Congress, almost by accident. As the last bill before the session adjourned for the year it received almost no review and was passed as speedily as possible. 

The reform was the newly appointed U.S. Census Chair's, Joseph C. G. Kennedy, implementation of a census questionairre to be admistered by federal agents traveling throughout the country. The questionairre contained six schedules, the second was to record information on the enslaved persons living on the premesis including their names and place of birth. When Congress reconvened in 1850 there was an immediate reaction to the bill followed by resistance. South Carolina Senator Andrew Butler moved that no names of enslaved persons should be recorded and Senator William King of Alabama quickly followed by demanding no city of birth be recorded for the enslaved. Both motions were speedily carried. (Berry, Count The Dead, 18-21)

While Congress, especially those from southern states, beat the life out of Schedule 2, what they failed to act on was Schedule 3 which contained the questions to be asked about who had died on the propery over the preceeding year and what had caused their death. So, the first mortality census was born.

The CSI:Dixie project produced by eHistory at the University of Georgia and is based on coroners reports in the South. They had created county datasets from ten South Carolina counties to date primarily from the 19th century. In this project, I beginning by examining the Greenville County dataset to understand the implications of the information from the coroners' inquests and then expand my focus to include Anderson, Chesterfield and Horry counties in order to examine regional similarities and differences.

```{r}
#load CSI:Dixie Greenville County data
CSI.GVL <- read.csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQzO3uN1w0-A_rN3bHuBWDr1iQe9hPZ68u7igu-I8wWDEpHSWH5T3AQFPvaa-VMSbuB8Z8X5wxSjmA6/pub?output=csv") 
```

```{r}
#tidy data
CSI.GVL.TIDY <- CSI.GVL %>%
  separate(NAME, c("FIRST.NAME", "LAST.NAME"), sep = " ", remove = FALSE) %>% #separates first and last names
  separate(DATE, c("MONTH", "DAY", "YEAR"), sep = " ", remove = FALSE) #separates dates into month, day, year
```

CSI:Greenville:

In Greenville County, coroner inquests increase dramatically in from 1850 through the end of the 1880s, with the 1870s and 80s having the highest occurrences by a significant margin.

```{r}
#plot Greenville deaths by year
ggplot(CSI.GVL.TIDY, aes(x = YEAR)) + theme(axis.text.x=element_text(angle=90, hjust=1)) + geom_dotplot(binwidth = 1) + labs(title = "Greenville Inquests by Year")

```

The most obvious explaination is that some types of death increases would necessarily correspond with the Civil War. For example, the homicide and suicide rates during the 1850s and 60s are the highest compared to all other decades. What is interesting, however, is that the types of death that would seem as if there would not be a tremendous fluctuation due to war (ie: accidents and natural causes) also see a large spike during these decades. 

```{r}
#Greenville deaths by type by year
by.year <- CSI.GVL.TIDY %>%
  group_by(YEAR, DEATH.TYPE) %>%
  summarize(count = n())

ggplot(by.year, aes(x = DEATH.TYPE, y = count)) + theme(axis.text.x=element_text(angle=90,hjust=1)) + geom_col() + facet_wrap(~YEAR) + labs(title = "Greenville Death Type by Year")
```


```{r}
death.type <- CSI.GVL.TIDY %>%
  group_by(DEATH.TYPE) %>%
  summarize(count = n())
  
ggplot(death.type, aes(x = DEATH.TYPE, y = count)) +  geom_col() 
```


```{r}
#chart by DEATH.TYPE
year.count <- CSI.GVL.TIDY %>%
  group_by(YEAR) %>%
  summarize(count = n())
  
ggplot(year.count, aes(x = YEAR, y = count)) +  geom_point(aes(size = count)) + theme(axis.text.x=element_text(angle=90,hjust=1)) 
```



```{r}
#group by decade - create a new dataframe by decade and average death types over years within that decade"

by.decade <- CSI.GVL.TIDY %>%
  mutate(DECADE = if_else(YEAR >= 1800 & YEAR < 1810, "Aughts",
                          if_else(YEAR >= 1810 & YEAR < 1820, "Tens",
                          if_else(YEAR >= 1820 & YEAR < 1830, "Twenties",
                          if_else(YEAR >= 1830 & YEAR < 1840, "Thirties",
                          if_else(YEAR >= 1840 & YEAR < 1850, "Forties",
                          if_else(YEAR >= 1850 & YEAR < 1860, "Fifties",
                          if_else(YEAR >= 1860 & YEAR < 1870, "Sixties",
                          if_else(YEAR >= 1870 & YEAR < 1880, "Seventies",
                          if_else(YEAR >= 1880 & YEAR < 1890, "Eighties",
                          if_else(YEAR >= 1890 & YEAR < 1900, "Nineties",                                   "Other"))))))))))) %>% as_tibble()
```

```{r}
#chart DEATH.TYPE by DECADE

decade.count <- by.decade %>%
  group_by(DECADE, DEATH.TYPE) %>%
  summarize(count = n())

ggplot(decade.count, aes(DEATH.TYPE, count)) + theme(axis.text.x=element_text(angle=90,hjust=1)) + geom_col() + facet_wrap(~DECADE)
```

```{r}
by.year <- CSI.GVL.TIDY %>%
  group_by(YEAR, DEATH.TYPE) %>%
  summarize(count = n()) %>%

ggplot(aes(x = DEATH.TYPE, y = count)) + theme(axis.text.x=element_text(angle=90,hjust=1)) + geom_col() + facet_wrap(~YEAR)
```

```{r}
#chart total number of deaths by decade
total.by.decade <- by.decade %>%
  group_by(NAME, DECADE) %>%
  summarize(count = n())
  
ggplot(total.by.decade, aes(x = DECADE, y = count)) +  geom_col() 
```



```{r}
age.sorted <- CSI.GVL.TIDY %>%
  mutate(AGE = if_else(str_detect(DECEASED.DESCRIPTION, "child"), "child",
                       if_else(str_detect(DECEASED.DESCRIPTION, "infant"), "child",
                        if_else(str_detect(DECEASED.DESCRIPTION, "boy"), "child", if_else(str_detect(DECEASED.DESCRIPTION, "son"), "child", "adult")))))

head(age.sorted)
```

```{r}
#adds sorting by race to dataframe previously sorted by age
all.sorted <- age.sorted %>%
  mutate(RACE = if_else(str_detect(DECEASED.DESCRIPTION, "black"), "black",
                  if_else(str_detect(DECEASED.DESCRIPTION, "negro"), "black",
                  if_else(str_detect(DECEASED.DESCRIPTION, "negroe"), "black",                          if_else(str_detect(DECEASED.DESCRIPTION, "colored"), "black",
                  if_else(str_detect(DECEASED.DESCRIPTION, "free"), "black",
                  if_else(str_detect(DECEASED.DESCRIPTION, "slave"), "black",                             "white")))))))

head(all.sorted)
```

In examining the coroners inquest from Greenville County it is clear that this practice of refusing to name or further identify black individuals trickled down from the highest governmental offices to the local levels. It is also clear that infants and children of undetermined race often were not named in the inquests.


CSI:Anderson

```{r}
#load Anderson County data
CSI.ANDERSON <- read.csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vSZ5lXF7WTLe71GUg6Z_h6HgtoeQJ6BX1JQ7H6IgkGvrXSqzxIh720ElLPeWmzoXytW2O9J7bgL82Kg/pub?output=csv") 
```

```{r}
CSI.ANDERSON.TIDY <- CSI.ANDERSON %>%
  separate(NAME, c("FIRST.NAME", "LAST.NAME"), sep = " ", remove = FALSE) %>% #separates first and last names
  separate(DATE, c("MONTH", "DAY", "YEAR"), sep = " ", remove = FALSE) #separates dates into month, day, year
```

```{r}
#group by decade - create a new dataframe by decade and average death types over years within that decade"

by.decade.anderson <- CSI.ANDERSON.TIDY %>%
  mutate(DECADE = if_else(YEAR >= 1800 & YEAR < 1810, "Aughts",
                          if_else(YEAR >= 1810 & YEAR < 1820, "Tens",
                          if_else(YEAR >= 1820 & YEAR < 1830, "Twenties",
                          if_else(YEAR >= 1830 & YEAR < 1840, "Thirties",
                          if_else(YEAR >= 1840 & YEAR < 1850, "Forties",
                          if_else(YEAR >= 1850 & YEAR < 1860, "Fifties",
                          if_else(YEAR >= 1860 & YEAR < 1870, "Sixties",
                          if_else(YEAR >= 1870 & YEAR < 1880, "Seventies",
                          if_else(YEAR >= 1880 & YEAR < 1890, "Eighties",
                          if_else(YEAR >= 1890 & YEAR < 1900, "Nineties",                                   "Other"))))))))))) %>% as_tibble()
```

```{r}
#chart Anderson by DEATH.TYPE
death.type.anderson <- CSI.ANDERSON.TIDY %>%
  group_by(DEATH.TYPE) %>%
  summarize(count = n())
  
ggplot(death.type.anderson, aes(x = DEATH.TYPE, y = count)) +  geom_col() 
```


```{r}
#chart DEATH.TYPE by DECADE

decade.count.anderson <- by.decade.anderson %>%
  group_by(DECADE, DEATH.TYPE) %>%
  summarize(count = n())

ggplot(decade.count.anderson, aes(DEATH.TYPE, count)) + theme(axis.text.x=element_text(angle=90,hjust=1)) + geom_col() + facet_wrap(~DECADE)
```

```{r}
#chart total number of Anderson deaths by decade
total.anderson.by.decade <- by.decade.anderson %>%
  group_by(NAME, DECADE) %>%
  summarize(count = n())
  
ggplot(total.anderson.by.decade, aes(x = DECADE, y = count)) +  geom_col() 
```

```{r}
#chart Anderson by year count
year.count.anderson <- CSI.ANDERSON.TIDY %>%
  group_by(YEAR) %>%
  summarize(count = n())
  
ggplot(year.count.anderson, aes(x = YEAR, y = count)) +  geom_point(aes(size = count)) + theme(axis.text.x=element_text(angle=90,hjust=1)) 
```

CSI:Chesterfield

```{r}
#load Chesterfield County data
CSI.CHESTERFIELD <- read.csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vSiyRbp_NP79e2pOWCwtrQRUFbZ0HrPkPI4XiR5qcREiRhq2ifqJGh0oKWSaB19GPgb2_Z5pzEOo6PN/pub?output=csv")
```

```{r}
CSI.CHESTERFIELD.TIDY <- CSI.CHESTERFIELD %>%
  separate(NAME, c("FIRST.NAME", "LAST.NAME"), sep = " ", remove = FALSE) %>% #separates first and last names
  separate(DATE, c("MONTH", "DAY", "YEAR"), sep = " ", remove = FALSE) #separates dates into month, day, year
```

```{r}
#group by decade - create a new dataframe by decade and average death types over years within that decade"

by.decade.chesterfield <- CSI.CHESTERFIELD.TIDY %>%
  mutate(DECADE = if_else(YEAR >= 1800 & YEAR < 1810, "Aughts",
                          if_else(YEAR >= 1810 & YEAR < 1820, "Tens",
                          if_else(YEAR >= 1820 & YEAR < 1830, "Twenties",
                          if_else(YEAR >= 1830 & YEAR < 1840, "Thirties",
                          if_else(YEAR >= 1840 & YEAR < 1850, "Forties",
                          if_else(YEAR >= 1850 & YEAR < 1860, "Fifties",
                          if_else(YEAR >= 1860 & YEAR < 1870, "Sixties",
                          if_else(YEAR >= 1870 & YEAR < 1880, "Seventies",
                          if_else(YEAR >= 1880 & YEAR < 1890, "Eighties",
                          if_else(YEAR >= 1890 & YEAR < 1900, "Nineties",                                   "Other"))))))))))) %>% as_tibble()
```

```{r}
#chart Chesterfield by DEATH.TYPE
death.type.chesterfield <- CSI.CHESTERFIELD.TIDY %>%
  group_by(DEATH.TYPE) %>%
  summarize(count = n())
  
ggplot(death.type.chesterfield, aes(x = DEATH.TYPE, y = count)) +  geom_col() 
```


```{r}
#chart DEATH.TYPE by DECADE

decade.count.chesterfield <- by.decade.chesterfield %>%
  filter(YEAR < 1900) %>%
  group_by(DECADE, DEATH.TYPE) %>%
  summarize(count = n())

ggplot(decade.count.chesterfield, aes(DEATH.TYPE, count)) + theme(axis.text.x=element_text(angle=90,hjust=1)) + geom_col() + facet_wrap(~DECADE)
```

```{r}
#chart total number of Chesterfield deaths by decade
total.chesterfield.by.decade <- by.decade.chesterfield %>%
  group_by(NAME, DECADE) %>%
  summarize(count = n())
  
ggplot(total.chesterfield.by.decade, aes(x = DECADE, y = count)) +  geom_col() 
```

```{r}
#chart Chesterfield by year count
year.count.chesterfield <- CSI.CHESTERFIELD.TIDY %>%
  group_by(YEAR) %>%
  summarize(count = n())
  
ggplot(year.count.chesterfield, aes(x = YEAR, y = count)) +  geom_point(aes(size = count)) + theme(axis.text.x=element_text(angle=90,hjust=1, size=5)) 
```


CSI:Horry

```{r}
#load Horry County data
CSI.HORRY <- read.csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQLbn85PImxeinLSgyS-CXgm3uPgp663HrzzVLeqYPa40QIaWWADQcbnhZBKR7MSHHzNFPk9PWdrBrh/pub?output=csv")
```

```{r}
CSI.HORRY.TIDY <- CSI.HORRY %>%
  separate(NAME, c("FIRST.NAME", "LAST.NAME"), sep = " ", remove = FALSE) %>% #separates first and last names
  separate(DATE, c("MONTH", "DAY", "YEAR"), sep = " ", remove = FALSE) #separates dates into month, day, year
```

```{r}
#group by decade - create a new dataframe by decade and average death types over years within that decade"

by.decade.horry <- CSI.HORRY.TIDY %>%
  arrange(YEAR) %>%
  mutate(DECADE = if_else(YEAR >= 1800 & YEAR < 1810, "Aughts",
                          if_else(YEAR >= 1810 & YEAR < 1820, "Tens",
                          if_else(YEAR >= 1820 & YEAR < 1830, "Twenties",
                          if_else(YEAR >= 1830 & YEAR < 1840, "Thirties",
                          if_else(YEAR >= 1840 & YEAR < 1850, "Forties",
                          if_else(YEAR >= 1850 & YEAR < 1860, "Fifties",
                          if_else(YEAR >= 1860 & YEAR < 1870, "Sixties",
                          if_else(YEAR >= 1870 & YEAR < 1880, "Seventies",
                          if_else(YEAR >= 1880 & YEAR < 1890, "Eighties",
                          if_else(YEAR >= 1890 & YEAR < 1900, "Nineties",                                   "Other"))))))))))) %>% as_tibble()
```

```{r}
#chart Horry by DEATH.TYPE
death.type.horry <- CSI.HORRY.TIDY %>%
  group_by(DEATH.TYPE) %>%
  summarize(count = n())
  
ggplot(death.type.horry, aes(x = DEATH.TYPE, y = count)) +  geom_col() 
```


```{r}
#chart DEATH.TYPE by DECADE

decade.count.horry <- by.decade.horry %>%
  arrange(YEAR) %>%
  group_by(DECADE, DEATH.TYPE) %>%
  summarize(count = n())

ggplot(decade.count.horry, aes(DEATH.TYPE, count)) + theme(axis.text.x=element_text(angle=90,hjust=1)) + geom_col() + facet_wrap(~DECADE)
```

```{r}
#chart total number of Horry deaths by decade
total.horry.by.decade <- by.decade.horry %>%
  group_by(NAME, DECADE) %>%
  summarize(count = n())
  
ggplot(total.horry.by.decade, aes(x = DECADE, y = count)) +  geom_col() 
```

```{r}
#chart Horry by year count
year.count.horry <- CSI.HORRY.TIDY %>%
  group_by(YEAR) %>%
  summarize(count = n())
  
ggplot(year.count.horry, aes(x = YEAR, y = count)) +  geom_point(aes(size = count)) + theme(axis.text.x=element_text(angle=90,hjust=1)) 
```

As I examine the data and begin to form comparisons, it is important to remember the two contributing factors to the recorded data gleaned from the coroners inquests. First, the state of public health that the inquests represent. Many cultural realities effect what people and deaths were examined by a coroner in 19th century South Carolina. For example, a woman who died during childbirth would most likely not have warrented a coronor's report. Second, the advent of the recording of death. The mortality census is the first time that the United States attempted to keep track of the people and mode of death of its residents. Although flawed, Berry argues that the ability to quantify death contributed to the doubling of the life expectancy between 1850-1950.

```{r}
#combines all tidy datasets for Greenville, Chesterfield, Anderson and Horry Counties. The reason I chose these three to compare to Greenville is geographical (from other areas of the state) and well as number of records available (Anderson is similar in size to Greenville, Chesterfield is one of the largest datasets and Horry the smallest)
COMBINED_CSI_TIDY <- rbind(CSI.GVL.TIDY, CSI.ANDERSON.TIDY, CSI.CHESTERFIELD.TIDY, CSI.HORRY.TIDY)
```

```{r}
#shows the year with the largest number of inquests from each county
highest.year <- COMBINED_CSI_TIDY %>%
  group_by(COUNTY, YEAR) %>%
  summarize(count = n()) %>%
  slice_max(count)

highest.year
```

```{r}
#limit the highest year to the 1800s - this is to adjust for Chesterfield being the only county with data into the 1900s as well as being the largest dataset
highest.year.filtered <- COMBINED_CSI_TIDY %>%
  group_by(COUNTY, YEAR) %>%
  summarize(count = n()) %>%
  filter(YEAR < 1900) %>%
  slice_max(count)

highest.year.filtered
```


Horry County saw its highest number of inquests in 1857. Anderson in 1876, Greenville in 1880 and Chesterfield County did not record its highest number until 1934. Horry, Anderson and Greenville follow the trend of the increase in inquests after the federal reform of 1850, but Chesterfield's peak is almost a half century late. Even when limiting the data to the 19th century, Chesterfield's highest year is 1894.


During Horry County's peak decade (1850s) the majority of inquests list homicide as the cause of death. Anderson's highest decade (1870s) saw a majority of accidents. For Greenville (1880s), accidents and natural causes are tied as the leading cause of death when a coroner prepared an inquest. Natural causes account for the majority of inquests during Chesterfield's highest 19th century decade (1890s).

By more closely examining the individual records of the highest cause of death in the most documented decade in each county patterns begin to emerge:

>Of the nine homicides between 1850-59, 2 were recorded by only a first name most likely indicating an African American individual.

```{r}
#List all Horry County deaths in 1850-59 with death type descending
horry.fifties <- by.decade.horry %>%
  filter(DECADE == "Fifties") %>%
  select(NAME, DECEASED.DESCRIPTION, DEATH.TYPE) %>%
  arrange(DEATH.TYPE)

horry.fifties

```

> Of the eighteen accident related deaths in Anderson from 1870-79 only two are listed without first and last names. One is "Smith" and another is referred to only as "colored". Of note, one of the individual listed is John Calhoun Clemson, Thomas Green and Anna Clemson's son. He was killed in a railway accident near Seneca.

```{r}
#List all Anderon County deaths in 1870-79 with death type descending
anderson.seventies <- by.decade.anderson %>%
  filter(DECADE == "Seventies") %>%
  select(NAME, DECEASED.DESCRIPTION, DEATH.TYPE) %>%
  arrange(DEATH.TYPE)

anderson.seventies

```

> There are thirteen accidents tied to a coroner's report in the 1880's in Greenville. There are none listed without surnames, but Julius Brockman is described as a black boy by in the CSI:Dixie data. The thirteen deaths described as natural causes are all recorded as first and last names.

```{r}
#List all Greenville County deaths in 1880-89 with death type descending
greenville.eighties <- by.decade %>%
  filter(DECADE == "Eighties") %>%
  select(NAME, DECEASED.DESCRIPTION, DEATH.TYPE) %>%
  arrange(DEATH.TYPE)

greenville.eighties
```

>Lastly, there are 58 deaths listed as natural causes in Chesterfield in the 1890's. None of the deaths are listed with surnames or described as an African American individual.

```{r}
#List all Chesterfield County deaths in 1890-99 with death type descending
chesterfield.nineties <- by.decade.chesterfield %>%
  filter(DECADE == "Nineties") %>%
  select(NAME, DECEASED.DESCRIPTION, DEATH.TYPE) %>%
  arrange(DEATH.TYPE)

chesterfield.nineties
```

What regional differences account for the variation in numbers of inquests? If, as Berry claims, you can judge the effectiveness of government by the health of it citizens, what forces account for the variances in the recorded deaths across South Carolina during the 19th century?
